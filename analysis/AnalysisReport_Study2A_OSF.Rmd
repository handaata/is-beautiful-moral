---
title: "AnalysisReport_Exp2A"
author: "DawnHan"
date: "2026-01-04"
output:
  html_document:
    code_folding: hide
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  fig.width = 10,
  fig.height = 6,
  fig.path = "../figs/",
  echo = TRUE,
  warning = FALSE,
  message = FALSE
)
```

```{css echo = FALSE}
body {
  font-size: 18px;
}
```

# Research Question: Do Attractive Face Bias Moral Judgments?

## Basic Info

**Research type:** Experimental, quantitative\
**Role:** End-to-end (survey design -\> data collection -\> data cleaning -\> analysis -\> interpretation)\
**Methods**: scale, survey
**Analysis:** reliability analysis, t-tests, effect sizes, mediational path analysis
**Tools:** R, tidyverse, ggplot2, lavaan, R Markdown

## Why this matters

People often infer trustworthiness, ethics, and credibility from visual cues.\
This project tests whether **perceived attractiveness systematically biases moral judgments**, and whether this effect is explained by assumptions about warmth and vanity.

## Data & Experimental Design

Participants were randomly assigned to view either a **high-attractiveness** or **low-attractiveness** target profile.\
They then rated the target on attractiveness, morality, immorality, and vanity using multi-item scales presented in random order. Items in each measure were also randomly ordered.

## Analysis

### 1. Setup

#### Load Libraries

```{r }
####libraries####
library(psych)
library(forcats)
library(plyr)
library(dplyr)
library(tidyr)
library(purrr)
library(tibble)
library(gtsummary)
library(ggplot2)
library(ggsignif)
library(semPlot)
library(semptools)
library(kableExtra)#for HTML formatted table
library(rstatix) #get_summary_stats
library(lavaan) #for mediation

```

#### Read data
```{r }
#Read data
dat <- read.csv("Data_Exp2A.csv")
```



#### Preview of data
```{r include=TRUE}
head(dat,5)
```


### 2. Prepare Variables

All composite measures were created by averaging scale items after reliability checks.

Morality Measure Composition: We compute Morality as the average of two measures (trait-level & global) to create a single index for analysis. This approach integrates both trait-level and global moral judgments while preserving equal weighting across scales.


```{r }

# Factor coding for categorical variables
dat$attract <- factor(dat$attract, levels = c("mod","high"))
dat <- dat %>%
  mutate(attract = fct_recode(attract,
                             "moderate"  = "mod",
                             "high" = "high")) # change label for better readability
levels(dat$attract) <-list("moderate"=1, "high"=2) #set levels for later contrast coding
dat$Gender <- factor(dat$Gender)
levels(dat$Gender) <-list("male"=1,"female"=2,"prefer not to say"=3,"other"=4)  #set levels for later contrast coding
dat$xGender <- factor(dat$xGender)
levels(dat$xGender) <-list("male"=1,"female"=2)  #set levels for later contrast coding
dat$face <-factor(dat$face)

# reverse-code negatively keyed items
dat <- dat %>%
  mutate(across(
    c("character_unethical", "character_unprincipled", 
      "character_dishonest", "character_untrustworthy", "moral_immorally"),
    ~ 8 - .x,
    .names = "{.col}_r"
  ))

#Aggregate variables
dat$vain <- rowMeans(
  dplyr::select(dat, starts_with("vain_")),
  na.rm = TRUE
)
dat$warm <- rowMeans(
  dplyr::select(dat, starts_with("warm_")),
  na.rm = TRUE
)

dat <- dat %>%
  rowwise() %>%
  mutate(
    Mcharacter = 
      mean(
      c(character_ethical, character_principled, character_honest, character_trustworthy, 
        character_unethical_r, character_unprincipled_r, character_dishonest_r,
        character_untrustworthy_r
        ), na.rm = TRUE
      ),
    Moral = mean(c(moral_morally, moral_immorally_r), na.rm = TRUE)
  ) %>%
  ungroup()

dat$Morality <- rowMeans(dat[,c("Mcharacter","Moral")], na.rm =TRUE) 


```


### 3. Descriptives, and Reliabilities

Note: We focus on the primary constructs used in hypothesis testing.

#### Descriptives

```{r}
dat %>%
  select(attract, vain, Morality) %>%
  psych::describe() %>%
  knitr::kable(digits = 2) %>%
  kable_styling()
```


#### Reliabilities
All multi-item measures showed acceptable to excellent reliability (α \>= 0.83).


```{r}
scales <- list(
  Vanity = c("vain_vain", "vain_egotistical", "vain_self.center"),
  MoralCharacter = c("character_ethical",
                     "character_principled",
                     "character_honest",
                     "character_trustworthy",
                     "character_unethical_r",
                       "character_unprincipled_r",
                       "character_dishonest_r",
                       "character_untrustworthy_r"),
  MorallyScales = c("moral_morally", "moral_immorally_r"),
  MoralScales = c("Mcharacter", "Moral"),
  
  Warmth = c("warm_sociable",
             "warm_happy",
             "warm_agreeable",
             "warm_easygoing",
             "warm_playful")
)


alpha_table <- map_df(
  names(scales),
  ~{
    a <- psych::alpha(dat[, scales[[.x]]], warnings = FALSE)
    tibble(
      Construct = .x,
      Items = length(scales[[.x]]),
      Alpha = round(a$total$raw_alpha, 2)
    )
  }
)

knitr::kable(
  alpha_table,
  caption = "Scale Reliability (Cronbach’s α)"
) %>%
  kableExtra::kable_styling(full_width = FALSE)

```



#### Correlations

Construct-level correlations were examined to confirm expected alignment between moral and character judgments.


```{r}
knitr::kable(cor(dat[, c("attractive","vain","warm","Morality")], 
    use = "pairwise.complete.obs"), digits = 2)%>%kable_styling()
```

<br>
<br>

## 4. Manipulation Check: Perceived Attractiveness

### Research question

Did the attractiveness manipulation successfully change perceived attractiveness ratings?

#### Mean comparison (t-test)



```{r, warning=FALSE, message=FALSE, include=TRUE}
dat %>%
  tbl_summary(
    by = attract,
    include = attractive,
    # Force the variable to be treated as continuous
    type = list(attractive ~ "continuous"), 
    statistic = list(attractive ~ "{mean} ({sd})"),
    digits = list(attractive ~ 2) 
  ) %>%
  add_p(test = list(attractive ~ "t.test"))

```


### Effect size


```{r, warning=FALSE, message=FALSE, include=TRUE}
cohen.d(dat$attractive,dat$attract, alpha=.05)
```


**Interpretation** Participants rated targets in the high-attractiveness condition as significantly more attractive than those in the moderate-attractiveness condition, with a medium-to-large effect size. This confirms that the manipulation functioned as intended.

#### Robustness check: Does the manipulation vary by gender?

```{r}
fit<- lm(attractive ~ attract * xGender * Gender, data = dat)

tbl_regression(fit, 
               label = list(
      attract = "Attractiveness Condition",
      xGender = "Target Gender",
      Gender  = "Participant Gender"
    ))
```


**Interpretation** No higher-order interactions meaningfully altered the main effect of attractiveness, suggesting the manipulation operated consistently across target and participant gender.
<br>
<br>

## 3. Effect of Attractiveness on Moral Judgments

### Research question

Does perceived attractiveness influence how moral or immoral a target is judged?

### Morality judgments

#### Mean comparison and effect size

```{r}
dat %>%
  tbl_summary(
    by = attract,
    include = Morality,
    # Force the variable to be treated as continuous
    type = list(Morality ~ "continuous"), 
    statistic = list(Morality ~ "{mean} ({sd})"),
    digits = list(Morality ~ 2) 
  ) %>%
  add_p(test = list(Morality ~ "t.test"))
```

### Visualization


```{r eval=FALSE}
tMorality <- dat %>% group_by(attract) %>% 
    get_summary_stats(Morality, type ="common")

ggplot(tMorality, aes(x = attract, y = mean, fill = attract)) +
geom_col(width = .6) +
geom_errorbar(
aes(ymin = mean - ci, ymax = mean + ci),
width = .15
) +
stat_summary(
  fun = "mean", 
  geom = "text", 
  aes(label = after_stat(round(y, 2))),
  vjust = -3                         
  ) +
geom_signif(
  comparisons = list(c("moderate", "high")),
  annotations = "** p <.01",         
  y_position = 6.2,             
  tip_length = 0.02             
)+
scale_x_discrete(labels = c("Moderate\nAttractiveness", "High\nAttractiveness")) +
scale_y_continuous(breaks = 0:7) +
coord_cartesian(ylim = c(1, 7)) +
labs(
title = "Effect of Attractiveness on Moral Judgments",
x = NULL,
y = "Mean Morality Rating"
) +
theme_minimal(base_size = 14) +
theme(legend.position = "none")

```



```{r echo = FALSE}
tMorality <- dat %>% group_by(attract) %>% 
    get_summary_stats(Morality, type ="common")

ggplot(tMorality, aes(x = attract, y = mean, fill = attract)) +
geom_col(width = .6) +
geom_errorbar(
aes(ymin = mean - ci, ymax = mean + ci),
width = .15
) +
stat_summary(
  fun = "mean", 
  geom = "text", 
  aes(label = after_stat(round(y, 2))),
  vjust = -3                         
  ) +
geom_signif(
  comparisons = list(c("moderate", "high")),
  annotations = "** p <.01",         
  y_position = 6.2,             
  tip_length = 0.02             
)+
scale_x_discrete(labels = c("Moderate\nAttractiveness", "High\nAttractiveness")) +
scale_y_continuous(breaks = 0:7) +
coord_cartesian(ylim = c(1, 7)) +
labs(
title = "Effect of Attractiveness on Moral Judgments",
x = NULL,
y = "Mean Morality Rating"
) +
theme_minimal(base_size = 14) +
theme(legend.position = "none")

```

### Effect size

```{r, include=TRUE}
cohen.d(dat$Morality, dat$attract, alpha = .05)
```

**Interpretation** Targets presented as highly attractive were judged as significantly more moral than moderately attractive targets, with a practically meaningful effect size.

### Robustness check: Gender effects

The main effect of attractiveness remained stable across target and participant gender.


```{r}
fit2 <- lm(
Morality ~ attract * Gender * xGender,
data = dat[dat$Gender %in% c("male", "female"), ]
)

tbl_regression(fit2, 
               label = list(
      attract = "Attractiveness Condition",
      xGender = "Target Gender",
      Gender  = "Participant Gender"
    ))

```

<br>
<br>

## 4. Mediation: Does Vanity and Warmth Explain the Attractiveness' Effect on Morality?

### Structural Equation Model: Dual-Path Model

A structural equation model was estimated to examine whether **attractiveness influenced perceived morality** through two parallel pathways: **vanity** and **warmth**.\
- **Attractiveness** was specified as the exogenous predictor.\
- **Vanity** and **warmth** were included as mediators.\
- Both mediators were allowed to covary to account for shared variance in evaluative judgments.

#### Define dual path model

```{r, warning=FALSE, message=FALSE, include=TRUE}
# Re-code attractiveness condition as 0/1 for better interpretability of the coefficients
dat<-dat %>%
  mutate(attract.coding = factor(attract, labels=c(0,1), levels = c("moderate","high")))

# Define dual path model
Model <- 'Morality ~ b1 * vain + b2 * warm + c * attract.coding
          vain ~ a1 * attract.coding
          warm ~ a2 * attract.coding
          indirect_vain := a1 * b1
          indirect_warm := a2 * b2
          total := c + (a1 * b1) + (a2 * b2)
          vain ~~ warm
          '
```


#### Fit SEM with bootstrap CI for indirect effects

```{r, warning=FALSE, message=FALSE, include=TRUE}
       
set.seed(490)
dualpath<- sem(model = Model,
                   data = dat,
                   se = "bootstrap",
                   bootstrap = 10000)
```


#### Standardized estimates & R²

```{r}
results.dualpath <-summary(dualpath,
        fit.measures = FALSE,
        standardize = TRUE,
        rsquare = TRUE)

results.dualpath
```


#### CI of indirect effect using Bootstrapping

```{r}

parameterEstimates(dualpath, ci = TRUE, level = 0.95, boot.ci.type = "perc")

```

#### Dual Path Model Plot

```{r echo=FALSE}
# Define the custom grid layout to create a dual path shape
ly_matrix <- layout_matrix(
  vain = c(1, 2), 
  attract.coding  = c(2, 1), 
  Morality  = c(2, 3),  
  warm = c(3, 2)  
)

p <- semPaths(
dualpath,
what = "std", # standardized estimates
whatLabels = "std",
layout = ly_matrix,

style = "lisrel",
edge.label.cex = 1.2,
label.cex = 1.2,
sizeMan = 20,
sizeMan2 = 8,
sizeLat = 9,

edge.color = "black",
residuals = FALSE,
intercepts = FALSE,

nCharNodes = 0, # full variable names
mar = c(6, 8, 6, 8 ), 
DoNotPlot = TRUE) %>% 
  set_curve(c("Morality ~ attract.coding" = -2)) %>% 
  change_node_label(
    label_list = list(
      list(node = "attract.coding", to = "Attractiveness"),
      list(node = "Morality", to = "Perceived Morality"),
      list(node = "vain", to = "Perceived Vanity"),
      list(node = "warm", to = "Perceived Warmth")
    )
  )


plot(p)

```

**Interpretation** Highly attractive targets were perceived as more vain and warmer.

Vanity and warmth partially mediated the effect of attractiveness on perceived morality.

The dual-path model accounts for shared variance between vanity and warmth, providing a clean, interpretable explanation of how attractiveness shapes moral impressions.
